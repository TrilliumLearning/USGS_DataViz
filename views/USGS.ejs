<!DOCTYPE html>
<html lang="en">
<head>
    <!--NOTE: Most Web WorldWind bak use jquery, Bootstrap and requirejs but those technologies are NOT-->
    <!--required by Web WorldWind. See SimplestExample.html for an example of using Web WorldWind without them.-->
    <meta charset="utf-8"/>
    <title>CitySmart - WorldWise v2</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <!--<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css">-->
    <link href="http://www.jqueryscript.net/css/jquerysctipttop.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="../css/menu.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" type="text/javascript"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script data-main="../scripts/Main1" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.17/require.min.js"></script>
    <style>
        #layerrequest {
            font-size: 16px;
            color: white;
            line-height: 1.2;
            display: -webkit-box;
            display: -webkit-flex;
            display: -moz-box;
            display: -ms-flexbox;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0 20px;
            width: 240px;
            height: 50px;
            margin-bottom:10px;
            border-radius: 25px;
            background: #9152f8;
            background: -webkit-linear-gradient(bottom, #7579ff, #b224ef);
            background: -o-linear-gradient(bottom, #7579ff, #b224ef);
            background: -moz-linear-gradient(bottom, #7579ff, #b224ef);
            background: linear-gradient(bottom, #7579ff, #b224ef);
            position: relative;
            z-index: 1;
            -webkit-transition: all 0.4s;
            -o-transition: all 0.4s;
            -moz-transition: all 0.4s;
            transition: all 0.4s;
        }
        /*#layerrequest::before{*/
        /*content: "";*/
        /*display: block;*/
        /*position: absolute;*/
        /*z-index: -1;*/
        /*width: 100%;*/
        /*height: 100%;*/
        /*border-radius: 25px;*/
        /*background-color: #fff;*/
        /*top: 0;*/
        /*left: 0;*/
        /*opacity: 1;*/
        /*-webkit-transition: all 0.4s;*/
        /*-o-transition: all 0.4s;*/
        /*-moz-transition: all 0.4s;*/
        /*transition: all 0.4s;*/
        /*}*/
        #layerrequest:hover{
            color: white;
        }
        #layerrequest:hover:before{
            opacity: 0;
        }
        #back{
            text-align:center;
            margin-top:50px;
        }
        .container-login100-form-btn {
            width: 100%;
            display: -webkit-box;
            display: -webkit-flex;
            display: -moz-box;
            display: -ms-flexbox;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }
        .banner{
            position:relative;
            width:100%;
            text-align:center;
            display:inline-block;
        }


    </style>

</head>
<body>
<div class="container">
    <div >
        <a href="http://aworldbridge.com"><img class="banner" src="../images/NewWBBanner.jpg"/></a>

        <!--<div id="back" class="container-login100-form-btn">-->
            <!--<a href="/login" id="layerrequest">-->
                <!--<i class="fa fa-long-arrow-left m-l-5" aria-hidden="true"></i>-->
                <!--</a>-->
        <!--</div>-->
        <div id="back" class="container-login100-form-btn">
            <a href="/login" id="layerrequest">
                Submit Layer Request &#10095;
            </a>
        </div>
        <div>
        <div class="row">
        <div class="col-sm-3">
            <div class="container">
                <br>
                <h4>Please Select Here First</h4>
                <div>
                    <p>
                        <select id="myListContinent"  style="width:180px; height:21px; background:white" onchange="ChangeSelectList(this.value)">
                            <option selected="selected" value="AL">All Layer</option>
                            <!--<option>United States of America</option>-->
                            <!--<option value="AL" selected="selected" class="a">All Layer</option>-->
                        </select>
                    </p>
                </div>
                <div>
                    <p>
                        <select id="myListCountry"  style="width:180px; height:21px; background:lightgray" onchange="ChangeStateList(this.value)" disabled>
                            <option selected="selected" value="AL">All Layer</option>
                            <!--<option>-Select a State-</option>-->
                        </select>
                    </p>
                </div>
                <div>
                    <p>
                        <select id="myListState"  style="width:180px; height:21px; background:lightgray" onchange="ChangeLayerList(this.value)" disabled>
                            <option selected="selected" value="AL">All Layer</option>
                        </select>
                    </p>
                </div>
            </div>
            <br>
            <div class="container">
                <h4>Menu</h4>
                <div class="panel-group medium-3" id="accordion"></div>
            </div><!-- /.panel-group -->
        </div>
        <div class="col-sm-9" id="globe">
            <canvas id="canvasOne" width="1000" height="1000" style="width: 100%; height: auto;">
                Your browser does not support HTML5 Canvas.
            </canvas>
        </div>

    </div>
        </div>
    </div>
</div>
</body>
<script>


    $(document).ready(function() {

        var parentmenu = document.getElementById("accordion");

        function unpack(rows, key) {
            return rows.map(function(row) { return row[key]; })
        }

        $.ajax({
            type: "GET",
            url: "createlayer",
            dataType: "json",
            success: function (res) {
                var firstlayer = [];
                var secondlayer = [];
                var thirdlayer = [];
                var layervalue =[];
                var comparing = [];
                var comparing3 = [];
                var classname = [];
                var removefirstlayer = unpack(res, 'FirstLayer');
                var removesecondlayer = unpack(res, 'SecondLayer');
                var removethirdlayer = unpack(res,"ThirdLayer");
                var Layerinfo = unpack(res,"LayerName");

                $.each(removefirstlayer, function (index, value) {
                    if($.inArray(value, firstlayer) === -1) firstlayer.push(value);
                });
                $.each(removesecondlayer, function (index, value) {
                    if($.inArray(value, secondlayer) === -1) secondlayer.push(value);
                });
                $.each(removethirdlayer, function (index, value) {
                    if($.inArray(value, thirdlayer) === -1) thirdlayer.push(value);
                });
                $.each(Layerinfo, function (index, value) {
                    layervalue.push(value);
                });

                if(comparing.length === 0){
                    comparing.push(["firstlayer","secondlayer"]);
                }
                if(comparing3.length === 0){
                    comparing3.push(["thirdlayer","layermenu"]);
                }
                if(classname.length === 0){
                    classname.push("classname");
                }

                var createfirstlayer = function() {


                    $.each(firstlayer, function (i) {

                        var paneldefault1 = document.createElement("div");
                        paneldefault1.className = "Menu panel panel-default " + firstlayer[i] ;
                        var panelheading1 = document.createElement("div");
                        panelheading1.className = "panel-heading";
                        var paneltitle1 = document.createElement("h4");
                        paneltitle1.className = "panel-title";
                        var collapsed1 = document.createElement("a");
                        collapsed1.className = "collapsed";
                        collapsed1.setAttribute("data-toggle", "collapse");
                        collapsed1.setAttribute("data-parent", "#accordion");
                        collapsed1.href = "#collapse" + i;
                        var firstlayername = document.createTextNode(firstlayer[i] + "  ");
                        firstlayername.className = "menuwords";
                        var collapseone = document.createElement("div");
                        collapseone.className = "panel-collapse collapse";
                        collapseone.id = "collapse" + i;
                        var panelbody1 = document.createElement("div");
                        panelbody1.className = "panel-body";
                        var panelgroup1 = document.createElement("div");
                        panelgroup1.className = "panel-group " + firstlayer[i];
                        panelgroup1.id = "nested" + i;

                        collapsed1.appendChild(firstlayername);
                        paneltitle1.appendChild(collapsed1);
                        collapseone.appendChild(panelbody1);
                        panelbody1.appendChild(panelgroup1);
                        panelheading1.appendChild(paneltitle1);
                        paneldefault1.appendChild(panelheading1);
                        parentmenu.appendChild(paneldefault1);
                        paneldefault1.appendChild(collapseone);
                        // firstlayer ending
                    });

                };
                var createotherlayer = function() {
                    $.each(res, function (i) {
                        for (var v = 0; v < comparing.length; v++) {
                            //secondlayer beginning
                            if (comparing[v][1] !== res[i].SecondLayer) {

                                if(v === comparing.length - 1) {
                                    var paneldefault2 = document.createElement("div");
                                    paneldefault2.id = res[i].SecondLayer;
                                    paneldefault2.className = "Menu panel panel-default "+ res[i].SecondLayer;
                                    var panelheading2 = document.createElement("div");
                                    panelheading2.className = "panel-heading";
                                    var paneltitle2 = document.createElement("h4");
                                    paneltitle2.className = "panel-title";
                                    var collapsed2 = document.createElement("a");
                                    collapsed2.className = "collapsed";
                                    collapsed2.setAttribute("data-toggle", "collapse");
                                    collapsed2.setAttribute("data-parent", "#nested");
                                    collapsed2.href = "#" + res[i].FirstLayer + "-" + res[i].SecondLayer;
                                    var secondlayername = document.createTextNode(res[i].SecondLayer + "  ");
                                    secondlayername.className = "menuwords";
                                    var nested1c1 = document.createElement("div");
                                    nested1c1.id = res[i].FirstLayer + "-" + res[i].SecondLayer;
                                    nested1c1.className = "panel-collapse collapse";
                                    var panelbody3 = document.createElement("div");
                                    panelbody3.className = "panel-body " + res[i].SecondLayer;

                                    paneldefault2.appendChild(panelheading2);
                                    panelheading2.appendChild(paneltitle2);
                                    paneldefault2.appendChild(nested1c1);
                                    nested1c1.appendChild(panelbody3);
                                    collapsed2.appendChild(secondlayername);
                                    paneltitle2.appendChild(collapsed2);

                                    document.getElementsByClassName("panel-group " + res[i].FirstLayer)[0].appendChild(paneldefault2);
                                    comparing.push([res[i].FirstLayer, res[i].SecondLayer]);
                                }
                            } else {
                                break;
                            }

                        }// secondlayer ending

                        if (res[i].LayerType === "Wmslayer") {
                            let continentnamestr = res[i].ContinentName.replace(/\s+/g, '');
                            let countrynamestr = res[i].CountryName.replace(/\s+/g, '');
                            let statenamestr = res[i].StateName.replace(/\s+/g, '');

                            for (var c = 0; c < comparing3.length; c++) {

                                if (comparing3[c][0] !== res[i].ThirdLayer) {

                                    if (c === comparing3.length - 1) {
                                        var checkboxdivG = document.createElement("div");
                                        checkboxdivG.className = "State " + res[i].ThirdLayer + " " + statenamestr + countrynamestr + continentnamestr;
                                        var checkboxh5G = document.createElement("h5");
                                        var checkboxaG = document.createElement("a");
                                        var checkaboxatG = document.createTextNode(res[i].ThirdLayer + "   ");
                                        checkaboxatG.className = "menuwords";
                                        var checkboxlabelG = document.createElement("label");
                                        checkboxlabelG.className = "switch right";
                                        var checkboxinputG = document.createElement("input");
                                        checkboxinputG.type = "checkbox";
                                        checkboxinputG.className = "wmsLayer input" + res[i].ThirdLayer;
                                        checkboxinputG.id = res[i].LayerType;
                                        checkboxinputG.setAttribute("value", res[i].LayerName);
                                        var checkboxspanG = document.createElement("span");
                                        checkboxspanG.className = "slider round";
                                        checkboxdivG.appendChild(checkboxh5G);
                                        checkboxaG.appendChild(checkaboxatG);
                                        checkboxh5G.appendChild(checkboxaG);
                                        checkboxh5G.appendChild(checkboxlabelG);
                                        checkboxlabelG.appendChild(checkboxinputG);
                                        checkboxlabelG.appendChild(checkboxspanG);
                                        document.getElementsByClassName("panel-body " + res[i].SecondLayer)[0].appendChild(checkboxdivG);
                                        comparing3.push([res[i].ThirdLayer, res[i].LayerName]);
                                        classname.push([res[i].ThirdLayer +" " + statenamestr + countrynamestr + continentnamestr, statenamestr]);

                                    }

                                } else {
                                    if (comparing3[c][1] !== res[i].LayerName) {
                                        document.getElementsByClassName("input" + res[i].ThirdLayer)[0].removeAttribute("value");
                                        comparing3[c][1] += "," + res[i].LayerName;
                                        document.getElementsByClassName("input" + res[i].ThirdLayer)[0].setAttribute("value", comparing3[c][1]);

                                    }
                                    if (classname[c][0] !== res[i].ThirdLayer +" "+ statenamestr + countrynamestr + continentnamestr) {
                                        classname[c][0] += " " + statenamestr + countrynamestr + continentnamestr;
                                        // classname[c][1] += res[i].CityName;
                                        document.getElementsByClassName("State " + res[i].ThirdLayer)[0].className = "State " + classname[c][0];

                                        if (classname[c][1] !== statenamestr) {

                                            document.getElementsByClassName(classname[c][0])[0].className += " " + statenamestr;
                                        }

                                    }

                                }
                            }
                        }

                        if (res[i].LayerType === "Placemark") {
                            let continentnamestr = res[i].ContinentName.replace(/\s+/g, '');
                            let countrynamestr = res[i].CountryName.replace(/\s+/g, '');
                            let statenamestr = res[i].StateName.replace(/\s+/g, '');
                            for (var a = 0; a < comparing3.length; a++) {

                                if (comparing3[a][0] !== res[i].ThirdLayer) {

                                    if (a === comparing3.length - 1) {
                                        var checkboxdiv = document.createElement("div");
                                        checkboxdiv.className = "State " + res[i].ThirdLayer + " " + countrynamestr + statenamestr + continentnamestr;
                                        var checkboxh5 = document.createElement("h5");
                                        var checkboxa = document.createElement("a");
                                        var checkaboxat = document.createTextNode(res[i].ThirdLayer);
                                        var checkboxlabel = document.createElement("label");
                                        checkboxlabel.className = "switch right";
                                        var checkboxinput = document.createElement("input");
                                        checkboxinput.type = "checkbox";
                                        checkboxinput.id = res[i].LayerType;
                                        checkboxinput.className = "input" + res[i].ThirdLayer;
                                        checkboxinput.setAttribute("value", res[i].LayerName);
                                        var checkboxspan = document.createElement("span");
                                        checkboxspan.className = "slider round";
                                        checkboxdiv.appendChild(checkboxh5);
                                        checkboxa.appendChild(checkaboxat);
                                        checkboxh5.appendChild(checkboxa);
                                        checkboxh5.appendChild(checkboxlabel);
                                        checkboxlabel.appendChild(checkboxinput);
                                        checkboxlabel.appendChild(checkboxspan);
                                        document.getElementsByClassName("panel-body " + res[i].SecondLayer)[0].appendChild(checkboxdiv);
                                        comparing3.push([res[i].ThirdLayer, res[i].LayerName]);
                                        classname.push([res[i].ThirdLayer +" " + statenamestr + countrynamestr + continentnamestr, statenamestr]);

                                    }
                                }
                                else {
                                    document.getElementsByClassName("input" + res[i].ThirdLayer)[0].setAttribute("value", res[i].LayerName);
                                    if (classname[a][0] !== res[i].ThirdLayer +" "+ statenamestr + " " + countrynamestr) {
                                        classname[a][0] += " " + statenamestr + countrynamestr + continentnamestr;
                                        document.getElementsByClassName("State " + res[i].ThirdLayer)[0].className ="State "+ classname[a][0];

                                        if (classname[a][1] !== statenamestr) {
                                            document.getElementsByClassName(classname[a][0])[0].className += " " + statenamestr;
                                        }

                                    }

                                }

                            }
                        }

                    });

                };
                createotherlayer(createfirstlayer());
            }
        });
    });
</script>
</html>